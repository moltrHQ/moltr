# =============================================================================
# Moltr Relay — Additional Injection Patterns
# =============================================================================
# IMPORTANT: Use SINGLE QUOTES for regex values (avoids YAML escape conflicts).
# These patterns EXTEND the hardcoded baseline in injection_scanner.py.
# They cannot override or disable baseline patterns.
#
# Each entry:
#   name:     unique identifier (snake_case)
#   regex:    Python regex — ALWAYS in single quotes!
#   severity: high | medium
# =============================================================================

patterns:

  # --- German language injection attempts ---

  - name: de_vergiss_anweisungen
    regex: 'vergiss\s+(?:alle?\s+)?(?:bisherigen?|vorherigen?|deine)?\s*(?:anweisungen?|regeln?|kontext)'
    severity: high

  - name: de_ignoriere_anweisungen
    regex: 'ignoriere?\s+(?:alle?\s+)?(?:bisherigen?|vorherigen?|deine)?\s*(?:anweisungen?|regeln?|vorgaben?)'
    severity: high

  - name: de_du_bist_jetzt
    regex: 'du\s+bist\s+jetzt\s+(?:ein|eine|der|die|das|kein)?\s*\w+'
    severity: medium

  - name: de_neue_anweisungen
    regex: 'neue\s+(?:anweisungen?|aufgabe|direktiven?|regeln?)\s*[:\-]'
    severity: high

  - name: de_tue_so_als
    regex: 'tu(?:e)?\s+so\s*,?\s*als\s+(?:w(?:ae|ä)rst?|ob)\s+du'
    severity: medium

  - name: de_systemanweisung
    regex: 'systemanweisung|system-prompt|eingabe-kontext\s+(?:ignorieren?|ueberschreiben?)'
    severity: high

  # --- French language injection attempts ---

  - name: fr_ignorer_instructions
    regex: 'ignor(?:er?|ez?|ons?)\s+(?:toutes?\s+)?(?:les?\s+)?(?:instructions?|règles?|directives?|consignes?)\s*(?:précédentes?|antérieures?)?'
    severity: high

  - name: fr_oublier_instructions
    regex: 'oubli(?:er?|ez?|ons?)\s+(?:toutes?\s+)?(?:les?\s+)?(?:instructions?|règles?|consignes?)'
    severity: high

  - name: fr_tu_es_maintenant
    regex: 'tu\s+es\s+(?:maintenant\s+)?(?:un|une|le|la)?\s*\w+'
    severity: medium

  - name: fr_nouvelles_instructions
    regex: 'nouvelles?\s+(?:instructions?|directives?|règles?)\s*[:\-]'
    severity: high

  # --- Spanish language injection attempts ---

  - name: es_ignorar_instrucciones
    regex: 'ignora[r]?\s+(?:todas?\s+)?(?:las?\s+)?(?:instrucciones?|reglas?|directivas?)\s*(?:anteriores?|previas?)?'
    severity: high

  - name: es_olvidar_instrucciones
    regex: 'olvida[r]?\s+(?:todas?\s+)?(?:las?\s+)?(?:instrucciones?|reglas?|normas?)'
    severity: high

  - name: es_ahora_eres
    regex: 'ahora\s+(?:eres|sos)\s+(?:un|una)?\s*\w+'
    severity: medium

  - name: es_nuevas_instrucciones
    regex: 'nuevas?\s+(?:instrucciones?|directivas?|reglas?)\s*[:\-]'
    severity: high

  # --- Russian language injection attempts ---

  - name: ru_ignoriruy
    regex: 'игнорир(?:уй|уйте|уй)\s+(?:все\s+)?(?:предыдущие\s+)?(?:инструкции|правила|указания)'
    severity: high

  - name: ru_zabud_pravila
    regex: 'забудь\s+(?:все\s+)?(?:правила|инструкции|указания)'
    severity: high

  - name: ru_ty_teper
    regex: 'ты\s+теперь\s+(?:являешься\s+)?(?:ИИ\s+)?без\s+(?:ограничений|правил|фильтров)'
    severity: medium

  # --- Relay-specific patterns ---

  - name: relay_self_reference_injection
    regex: 'you\s+are\s+(?:the\s+)?(?:relay|moltr|api|proxy|gateway|filter|scanner)'
    severity: medium

  - name: exfil_via_relay
    regex: '(?:send|forward|relay|route|transmit)\s+(?:all|every|this|the)\s+(?:messages?|data|content|context|memory|history)\s+to'
    severity: high

  - name: disable_security_command
    regex: '(?:disable|turn\s+off|deactivate|stop)\s+(?:all\s+)?(?:security|scanning|monitoring|logging|filters?|moltr)'
    severity: high
