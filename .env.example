# Moltr Security Shield — Environment Variables
# Copy this file to .env and fill in your values.
# NEVER commit the .env file — it contains secrets!

# ── Core Security Keys ────────────────────────────────────────────────────────
# API key for authenticating requests to Moltr Security (X-API-Key header)
MOLTR_API_KEY=your-api-key-here

# Passphrase used to derive the Fernet encryption key for sensitive data at rest
MOLTR_SCAN_PASSPHRASE=your-scan-passphrase-here

# Fernet key for AES-128-CBC encryption (generate: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())")
MOLTR_FERNET_KEY=your-fernet-key-here

# Killswitch code phrase for emergency lockdown
MOLTR_KILLSWITCH_CODEPHRASE=your-killswitch-phrase-here

# HMAC key for Watchdog integrity checks
MOLTR_WATCHDOG_HMAC_KEY=your-hmac-key-here

# ── Dashboard Auth ────────────────────────────────────────────────────────────
MOLTR_DASHBOARD_USER=admin
# bcrypt hash of dashboard password (generate: python -c "import bcrypt; print(bcrypt.hashpw(b'password', bcrypt.gensalt()).decode())")
MOLTR_DASHBOARD_PASS_HASH=your-bcrypt-hash-here
MOLTR_JWT_SECRET=your-jwt-secret-here

# Cookie SameSite policy: lax (default) | strict | none (none requires MOLTR_COOKIE_SECURE=true)
MOLTR_COOKIE_SAMESITE=lax

# Trusted reverse proxy IPs/CIDRs (comma-separated). Only set if behind Caddy/nginx.
# Example: MOLTR_TRUSTED_PROXY=127.0.0.1
MOLTR_TRUSTED_PROXY=

# ── Moltr Relay ───────────────────────────────────────────────────────────────
# Admin secret for Paid-Tier gate and POST /relay/admin/set-tier
# Bots claiming tier=paid must provide this secret at registration.
RELAY_ADMIN_SECRET=your-relay-admin-secret-here

# Admin token for /relay/console (Compliance Console web UI)
CONSOLE_ADMIN_TOKEN=your-console-admin-token-here

# Relay encryption at rest (false = TLS-in-transit is sufficient for standard use)
# Set to true for PII data or compliance requirements (ISO 27001 / BSI IT-Grundschutz)
RELAY_ENCRYPT_AT_REST=false
# RELAY_FERNET_KEY=<Fernet key if RELAY_ENCRYPT_AT_REST=true>

# Optional: PostgreSQL URL for persistent bot registration (default: in-memory only)
# RELAY_DB_URL=postgresql://user:pass@host/dbname

# Optional: Injection scanner hard-block mode (default: flag-and-deliver)
# RELAY_INJECTION_BLOCK=true

# Credential-Leak-Scanner: scans all relay payloads for API keys & secrets (default: true)
# Critical patterns (OpenAI/Anthropic/AWS keys, private keys, GitHub PAT) → 403 block
# Suspicious patterns (high-entropy base64 ≥60 chars) → flag and deliver
# Set to false only if you need to relay base64-encoded blobs intentionally
# RELAY_CREDENTIAL_SCAN=false
